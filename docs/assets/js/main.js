"use strict";let changedEl;const handleListInput=t=>{changedEl=t.currentTarget.id;for(const a of data)a.id===parseInt(changedEl)&&(a.title=t.currentTarget.value);setInLS()},handleModalTitle=t=>{changedEl=t.currentTarget.id;for(const a of data)for(const s of a.cards)s.id===changedEl&&(s.title=t.currentTarget.value);setInLS()},handleModalDesc=t=>{changedEl=t.currentTarget.id;for(const a of data)for(const s of a.cards)s.id===changedEl&&(s.description=t.currentTarget.value);setInLS()};let num=0;const handleAddCard=t=>{clickedID=t.currentTarget.id;for(let t=0;t<data.length;t++)console.log(num),data[t].id===parseInt(clickedID)&&data[t].cards.push({id:Date.now().toString(),title:"Título de la tarea",description:"descripción de la tarea",tags:["JS","Css","Html"]});setInLS(),paintList()},handleAddCol=t=>{data.push({cards:[],id:Date.now(),title:"Descripción"}),setInLS(),paintList()},handleModalDel=t=>{changedEl=t.currentTarget.id;for(const t of data)for(let a=0;a<t.cards.length;a++)t.cards[a].id===changedEl&&t.cards.splice(a,1);setInLS(),paintList()},handleDelCol=t=>{changedEl=t.currentTarget.id;for(let t=0;t<data.length;t++)console.log(data[t].id,changedEl),data[t].id===parseInt(changedEl)&&data.splice(t,1);setInLS(),paintList()};let clickedID,foundCard,newArticle;const handleCard=t=>{clickedID=t.currentTarget.id;for(const t of data)for(const a of t.cards)a.id!==parseInt(clickedID)&&a.id!==clickedID||(foundCard=a);newArticle=document.createElement("article"),newArticle.className="js-edit js-edit-close app-edit modal show",getMain.appendChild(newArticle),paintModal()},paintModal=()=>{const t=document.querySelector(".js-edit");let a="";a+='<section class="js-edit-modal modal-dialog modal-dialog-centered modal-lg">',a+='<div class="modal-content bg-light shadow border-0">',a+=" <form>",a+=' <div class="modal-header border-bottom-0">',a+='<h5 class="modal-title d-flex w-100">',a+='<span class="fas fa-columns mt-3 mr-2 text-muted"></span>',a+='<div class="w-100">',a+=`<input id=${foundCard.id} class="js-modal-title app-edit-title form-control mb-0 border-0" placeholder="Filtrar tarjetas" type="text" value="${foundCard.title}" />`,a+='<small class="app-edit-subtitle d-block mt-0 text-muted"> en la lista <strong>Por hacer</strong> </small>',a+="</div>",a+="</h5>",a+='<button type="button" class="js-edit-close js-close-modal close" data-dismiss="modal">',a+="<span>&times;</span>",a+="</button>",a+="</div>",a+=' <div class="modal-body">',a+='<div class="row">',a+='<div class="col-xl-9 col-8">',a+='<div class="container-fluid mb-4">',a+='<div class="row">',a+='<div class="col-1 pl-0 pr-0">',a+='<span class="fas fa-align-left text-muted"></span>',a+="</div>",a+='<div class="col-11 pl-0 pr-0">',a+='<h6 class="h6">Descripción</h6>',a+=`<textarea id=${foundCard.id} class="app-edit-textarea js-modal-textarea">`,a+=`"${foundCard.description}"`,a+="</textarea>",a+="</div>",a+="</div>",a+="</div>",a+='<div class="container-fluid mb-4">',a+='<div class="row">',a+='<div class="col-1 pl-0 pr-0">',a+='<span class="far fa-check-square text-muted"></span>',a+="</div>",a+='<div class="col-11 pl-0 pr-0">',a+='<h6 class="h6 mb-3">Subtareas: completadas 3 de 5</h6>',a+='<div class="app-edit-progress progress mb-3">',a+='<div class="progress-bar" style="width: 60%;"></div>',a+="</div>",a+='<div class="custom-control custom-checkbox mb-2">',a+='<input class="custom-control-input" type="checkbox" checked id="subtask-1" />',a+='<label class="custom-control-label" for="subtask-1">',a+="Unificar los eventos",a+="</label>",a+="</div>",a+='<div class="custom-control custom-checkbox mb-2">',a+='<input class="custom-control-input" type="checkbox" checked id="subtask-2" />',a+='<label class="custom-control-label" for="subtask-2">',a+="Unificar las clases de la cabecera",a+="</label>",a+="</div>",a+='<div class="custom-control custom-checkbox mb-2">',a+='<input class="custom-control-input" type="checkbox" id="subtask-3" />',a+='<label class="custom-control-label" for="subtask-3">',a+="Unificar las clases de las tarjetas",a+="</label>",a+="</div>",a+='<div class="custom-control custom-checkbox mb-2">',a+='<input class="custom-control-input" type="checkbox" checked id="subtask-4" />',a+='<label class="custom-control-label" for="subtask-4">',a+="Unificar las funciones de datos",a+="</label>",a+="</div>",a+='<div class="custom-control custom-checkbox mb-2">',a+='<input class="custom-control-input" type="checkbox" id="subtask-5" />',a+='<label class="custom-control-label" for="subtask-5">',a+="Unificar las estilos",a+="</label>",a+="</div>",a+="</div>",a+="</div>",a+="</div>",a+="</div>",a+=' <div class="col-xl-3 col-4">',a+='<h6 class="h6 text-uppercase">Etiquetas</h6>',a+='<div class="mb-4">';for(const t of foundCard.tags)a+=`<span class="badge badge-secondary bg-success">${t}</span>`;a+="</div>",a+='<h6 class="h6 text-uppercase">Acciones</h6>',a+='<button type="button" class="btn btn-primary btn-sm mb-2 w-100 text-left">',a+='<span class="fas fa-copy mr-2"></span>',a+="Duplicar",a+="</button>",a+='<button type="button" class="btn btn-primary btn-sm mb-2 w-100 text-left">',a+='<span class="fas fa-share-alt mr-2"></span>',a+="Mover",a+="</button>",a+=`<button id=${foundCard.id} type="button" class="js-mod-del-btn btn btn-primary btn-sm mb-2 w-100 text-left">`,a+='<span class="fas fa-trash-alt mr-2"></span>',a+="Borrar",a+="</button>",a+="</div>",a+="</div>",a+="</div>",a+="</form>",a+="</div>",a+="</section>",t.innerHTML=a,addListener(".js-close-modal","click",handleBtn),addListener(".js-modal-title","change",handleModalTitle),addListener(".js-modal-textarea","change",handleModalDesc),addListener(".js-mod-del-btn","click",handleModalDel)},handleBtn=()=>{newArticle.remove(),paintList()};let data;const getData=()=>{fetch("../../api/board.json").then(t=>t.json()).then(t=>{for(let a=0;a<t.board.list.length;a++)t.board.list[a].id=a;return data=t.board.list,console.log(data),paintList(),data})},addListener=(t,a,s)=>{document.querySelector(t).addEventListener(a,s)},addListenerAll=(t,a,s)=>{document.querySelectorAll(t).forEach(t=>{t.addEventListener(a,s)})},getMain=document.querySelector(".js-main"),paintList=()=>{let t="";for(const a of data){t+='<div class="app-list">',t+=' <div class="p-1 rounded-sm bg-primary shadow">',t+=' <form class="app-list-form align-middle p-1 position-relative">',t+=` <input id=${a.id} value='${a.title}' class="js-list app-list-input form-control form-control-sm" placeholder="Tareas importantes" type="text" title="Editar el título de la lista" />`,t+='<div class="app-list-options">',t+=' <span class="pl-2 pr-2 text-white-50 fas fa-ellipsis-v"></span>',t+=' <div class="app-list-btns btn-group btn-group-sm">',t+=`<button id=${a.id} type="button" class="js-del-col-btn btn btn-light text-muted border shadow-sm" title="Borrar esta tarjeta">`,t+='<span class="fas fa-trash-alt"></span>',t+="</button>",t+='<button type="button" class="btn btn-light text-muted border shadow-sm app-list-move-left" title="Mover esta lista hacia la izquierda">',t+='<span class="fas fa-arrow-left"></span>',t+="</button>",t+='<button type="button" class="btn btn-light text-muted border shadow-sm app-list-move-right" title="Mover esta lista hacia la derecha">',t+='<span class="fas fa-arrow-right"></span>',t+="</button>",t+="</div>",t+="</div>",t+="</form>";for(const s of a.cards){t+=`<article id=${s.id} class="js-card app-card m-1 mb-2 p-2 bg-white rounded-sm app-cursor-pointer shadow-sm" title="Abrir la tarjeta">`,t+="<div>";for(const a of s.tags)t+=`<span class="badge badge-secondary bg-success">${a}</span>`;t+="</div>",t+="<div>",t+=`<h3 class="h6">${s.title}</h3>`,t+="</div>",t+='<div class="text-black-50">',t+='<small class="pr-2 fas fa-align-left"></small>',t+='<small class="far fa-check-square"></small>',t+='<small title="Subtareas completadas: 3 de 5">3/5</small>',t+="</div>",t+='<div class="app-card-btns btn-group-vertical btn-group-sm">',t+=`<button id=${s.id} type="button" class="js-arrow-up btn btn-light text-muted border shadow-sm app-card-move-up" title="Mover esta tarjeta hacia abajo">`,t+='<span class="fas fa-arrow-up"></span>',t+="</button>",t+=`<button id=${s.id} type="button" class="js-arrow-down btn btn-light text-muted border shadow-sm app-card-move-down" title="Mover esta tarjeta hacia arriba">`,t+='<span class="fas fa-arrow-down"></span>',t+="</button>",t+="</div>",t+="</article>"}t+=`<button type="button" id=${a.id} class="js-new-card-btn ml-1 btn btn-primary btn-sm text-white-50" title="Añadir una nueva tarjeta">`,t+='<span class="fas fa-plus"></span>',t+="Añadir otra tarjeta",t+="</button>",t+="</div>",t+="</div>"}t+='<div>\n  <button type="button" class="js-btn-add-col btn btn-light btn-outline-primary btn-sm mr-5 shadow-sm" title="Añadir una nueva lista">\n    <span class="fas fa-plus"></span>\n  </button>\n</div>',getMain.innerHTML=t,addListenerAll(".js-card, .js-edit-close","click",handleCard),addListenerAll(".js-list","keyup",handleListInput),addListener(".js-btn-add-col","click",handleAddCol),addListenerAll(".js-del-col-btn","click",handleDelCol),addListenerAll(".js-new-card-btn","click",handleAddCard)},getFromLs=()=>{const t=localStorage.getItem("data");null!==t?(data=JSON.parse(t),paintList()):fetch("../../api/board.json").then(t=>t.json()).then(t=>{for(let a=0;a<t.board.list.length;a++)t.board.list[a].id=a;return data=t.board.list,console.log(data),paintList(),data}),console.log(data)},setInLS=()=>{localStorage.setItem("data",JSON.stringify(data))};getFromLs();const toggleMenu=()=>{document.querySelector(".js-menu").classList.toggle("show")};document.querySelectorAll(".js-menu-btn").forEach(t=>{t.addEventListener("click",toggleMenu)});let filteredData=[];const handleFilter=t=>{for(const a of data)console.log(a.cards),filteredData=a.cards.filter(a=>a.cards.title.includes(t.currentTarget.value));console.log(filteredData)};addListener(".js-filter-input","keyup",handleFilter);